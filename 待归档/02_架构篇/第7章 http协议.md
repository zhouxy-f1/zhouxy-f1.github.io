## 概述



**超文本：**包含有超链接(Link)和各种多媒体元素标记(Markup)的文本。这些超文本文件彼此链接，形成网状(Web)，因此又被称为网页(Web Page)。这些链接使用URL表示。最常见的超文本格式是超文本标记语言HTML。

**URL：**统一资源定位符，是Uniform Resource Locator的缩写，由协议、主机、端口三部分构成，用来标识全网唯一文档

**http：**超文件传输协议，是Hyper Text Transfer Protocol的缩写，是按照URL指示，将超文本文档从一台主机(Web服务器)传输到另一台主机(浏览器)的应用层协议，以实现超链接的功能。



## http工作原理

当用户在浏览器网址或点击URL后，浏览器和web服务器工作流程如下：

##### DNS解析

1.用输入域名  > 浏览器跳转  > 浏览器缓存  > Hosts文件  > DNS解析（递归查询|迭代查询）
客户端向服务端发起查询 - > 递归查询
服务端向服务端发起查询 - > 迭代查询

##### 三次握手

2.由浏览器向服务器发起TCP连接（三次握手）
客户端     -->请求包连接 -syn=1 seq=x           服务端
服务端     -->响应客户端syn=1 ack=x+1 seq=y     客户端
客户端     -->建立连接 ack=y+1 seq=x+1          服务端

##### 浏览器请求

3.客户端发起http请求：
1）请求的方法是什么:     GET获取
2）请求的Host主机是:     www.driverzeng.com
3）请求的资源是什么:     /index.html
4）请求的端端口是什么:    默认http是80 https是443
5）请求携带的参数是什么:   属性（请求类型、压缩、认证、浏览器信息、等等）
6）请求最后的空行

##### 服务器响应

4.服务端响应的内容是
1）服务端响应使用WEB服务软件
2）服务端响应请求文件类型
3）服务端响应请求的文件是否进行压缩
4）服务端响应请求的主机是否进行长连接 

##### 四次挥手

5.客户端向服务端发起TCP断开（四次挥手）
客户端     --> 断开请求 fin=1 seq=x          -->    服务端
服务端     --> 响应断开 fin=1 ack=x+1 seq=y  -->    客户端
服务端     --> 断开连接 fin=1 ack=x+1 seq=z  -->    客户端
客户端     --> 确认断开 fin=1 ack=x+1 seq=sj -->    服务端

## Headers

##### General

```shell

#请求的url
Request URL:
#请求方式
Request Method:
#状态码
Status Code: 
#远程主机IP
Remote Address: 
#控制请求头内容
Referer Policy:
```

##### Response Headers

```shell

#大小
Accept-Range:
#阿里云存储保存时间
ali-swift-global-savetime: 
#缓存控制
cache-control: 
#压缩
content-encoding:
#内容长度
content-length: 
#返回内容类型及字符集
content-type: 
#返回服务器时间
date: 
#加密id
eagleid: 
#失效时间
expires: 
#软链接
link: 
#参数：没有缓存
pragma: 
#响应头包含处理请求的原始服务器的软件信息
server: 
#状态码
status: 
#指定特定站点允许访问
timing-allow-origin: 
#渲染
vary: 
#经过各级缓存
via: 
-------- 以下是CND厂商带的 ------
#CDN缓存是否命中
x-cache: MISS TCP_MISS dirn:-2:-2
#缓存版本号
x-powered-by: PHP/7.1.21
#缓存时间
x-swift-cachetime: 0
#保存时间
x-swift-savetime: Sat, 03 Aug 2019 06:30:33 GMT
```

##### Request Headers

```shell
#请求的域名
:authority: 
#请求的方式
:method:
#请求的路径
:path:
#请求的协议：https
:scheme:
#请求资源类型
accept: 
#压缩
accept-encoding: 
#语言
accept-language:
#缓存控制（没有做缓存）
cache-control: 
#保持连接：长连接
Connetection:keep-alive
#请求的域名
Host：
#登录信息
cookie: 
#参数：没有缓存
pragma:
#谷歌自带的（不属于请求头的内容）
upgrade-insecure-requests: 
#浏览器标识（操作系统标识；加密等级标识；浏览器语言）渲染引擎标识 版本信息
user-agent: 
```



## http请求方法

在HTTP请求报文中的方法(Method)，是对所请求对象所进行的操作，也就是一些命令。请求报文中的操作有：

| 方法(Method) | 含义                               |
| :----------- | :--------------------------------- |
| GET          | 请求读取一个Web页面                |
| POST         | 请求向指定的资源提交要被处理的数据 |
| DELETE       | 删除Web页面                        |
| CONNECT      | 用于代理服务器                     |
| HEAD         | 请求读取一个Web页面的头部          |
| PUT          | 请求存储一个Web页面                |
| TRACE        | 用于测试，要求服务器送回收到的请求 |
| OPTION       | 查询特定选项                       |

## http响应状态码

##### 临时响应

```shell
100 （继续）客户端应当继续提出请求。 服务器返回此代码表示已收到请求的第一部分，正在等待其余部分。
101 （切换协议）客户端已要求服务器切换协议，服务器已确认并准备切换 
```

##### 成功响应

```shell

200   （成功） 服务器已成功处理了请求。
201   （已创建） 请求成功并且服务器创建了新的资源。
202   （已接受） 服务器已接受请求，但尚未处理。
203   （非授权信息） 服务器已成功处理了请求，但返回的信息可能来自另一来源。
204   （无返回） 服务器成功处理了请求，但没有返回任何内容。
205   （重置内容）服务器成功处理了请求，但没有返回任何内容。
206   （部分响应） 服务器成功处理了部分 GET 请求。

```

##### 重定向

```shell

300   （多种选择） 针对请求，服务器可执行多种操作。服务器可根据请求选择一项操作，或提供操作列表供请求者选择。
#301   （永久重定向) 用户首次访问A域名后，A回复跳转，浏览器记录下来放缓存。下次访问不再询问A，直接跳转到B,除非清缓存
#302   （临时移动） 浏览器不记录跳转信息，每次都会访问A，A回复让跳转后再跳转
303   （查看其他位置） 请求者应当对不同的位置使用单独的 GET 请求来检索响应时，服务器返回此代码。
#304   （本地缓存） 用户发起请求后，浏览器发现请求的内容在缓存里有，不需要经过服务器，就从本地提取给用户
				1.from memory cache  状态码200 资源在内存中，如脚本、字体、图片等随时会执行，因此放内存
				2.from disk cache		 状态码200 资源在磁盘中，如css等非脚本文件，用一次即可渲染出网页，放磁盘即可
				3.资源本身的大小(如：1.5k) 状态码为200时，指资源本身大小；状态码为304时，指与服务端通迅报文的大小
				
305   （使用代理） 请求者只能使用代理访问请求的网页。 如果服务器返回此响应，还表示请求者应使用代理。
307   （内部重定向） 服务器目前从不同位置的网页响应请求，但请求者应继续使用原有位置来进行以后的请求。

```

##### 客户端响应

```shell
400   （错误请求） 服务器不理解请求的语法。
#401   （未授权） web服务器要求的auth_basic_user_file认证不通过，没有输入正确的用户名密码
#403   （权限不足+文件未找到）
				文件未找到：在虚拟主机server{}上指定的默认主页（index index.html;）文件在站点目录中未找到
				权限不足：
#404   （未找到） 当用户请求具体的文件或页面，此页面在站点目录下用户指定的目录里不存在时，返回404；
405   （方法禁用） 禁用请求中指定的方法。
406   （不接受） 无法使用请求的内容特性响应请求的网页。
407   （需要代理授权） 此状态代码与 401（未授权）类似，但指定请求者应当授权使用代理。
408   （请求超时）  服务器等候请求时发生超时。
409   （冲突）  服务器在完成请求时发生冲突。 服务器必须在响应中包含有关冲突的信息。
410   （已删除）  如果请求的资源已永久删除，服务器就会返回此响应。
411   （需要有效长度） 服务器不接受不含有效内容长度标头字段的请求。
412   （未满足前提条件） 服务器未满足请求者在请求中设置的其中一个前提条件。
413   （请求实体过大） 服务器无法处理请求，因为请求实体过大，超出服务器的处理能力。
414   （请求的 URI 过长） 请求的 URI（通常为网址）过长，服务器无法处理。
415   （不支持的媒体类型） 请求的格式不受请求页面的支持。
416   （请求范围不符合要求） 如果页面无法提供请求的范围，则服务器会返回此状态代码。
417   （未满足期望值） 服务器未满足"期望"请求标头字段的要求。

```

##### 服务端响应

```shell
#500   （服务器内部错误）	一般是代码问题，导致连不上数据库
501   （尚未实施） 服务器不具备完成请求的功能。 例如，服务器无法识别请求方法时可能会返回此代码。
#502   （错误网关） 负载均衡无法通过tcp连接上web服务器
#503   （服务不可用） 用户请求过多，导致服务器扛不住压力而过载；或停机维护时报503
#504   （网关超时）  负载均衡能通过tcp连接到后端web服务器，但服务器返回信息太慢，导致超过
505   （HTTP 版本不受支持） 服务器不支持请求中所用的 HTTP 协议版本。 

```



## http访问流程

##### 请求流程

![img](http://ww3.sinaimg.cn/large/006tNc79ly1g60h1rnbwyj311g0eago8.jpg)

##### 访问架构流程

浏览器请求  >  CDN层   >  负载均衡  >    web层   >  存储层   >  缓存层   >   数据库层

## http相关术语

##### PV 

pv数=访问日志数量 ，/var/log/httpd/access_log下查询，新打开网站时会加载一部分，后面每刷新一次或跳转一次产生一条记录

##### UV

独立设备数，每一个UV代表一个访客，（PC端和手机端算两个独立设备）

##### IP

指外网地址，同通过NAT转换的私有IP在一局域网下，对外出口可有一个

##### SOA

松耦合架构，是把应用程序的不同功能单元拆分开，再通过接口联系起来







打开新页面，出现N个pv，怎么计算出来的



![img](http://www.easemob.com/data/upload/ueditor/20191205/5de87413bcb01.jpg)







